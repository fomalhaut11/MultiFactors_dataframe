# å¤šå› å­é‡åŒ–ç³»ç»Ÿ - é¡¹ç›®ç»“æ„

## é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªç»è¿‡å·¥ç¨‹é‡æ„çš„å¤šå› å­é‡åŒ–æŠ•èµ„ç³»ç»Ÿï¼Œå…·å¤‡ç”Ÿäº§çº§åˆ«çš„ä»£ç è´¨é‡å’Œæ€§èƒ½è¡¨ç°ã€‚

## ç›®å½•ç»“æ„

```
mulitfactors_beta/
â”œâ”€â”€ ğŸ“‹ é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ README.md                    # é¡¹ç›®ä»‹ç»å’Œå¿«é€Ÿå¼€å§‹
â”‚   â”œâ”€â”€ PROJECT_STATUS.md            # å½“å‰é¡¹ç›®çŠ¶æ€
â”‚   â”œâ”€â”€ REFACTORING_SUMMARY.md       # é‡æ„æ€»ç»“æŠ¥å‘Š
â”‚   â”œâ”€â”€ PROJECT_STRUCTURE.md         # æœ¬æ–‡ä»¶ï¼Œé¡¹ç›®ç»“æ„è¯´æ˜
â”‚   â””â”€â”€ config.yaml                  # ä¸»é…ç½®æ–‡ä»¶
â”‚
â”œâ”€â”€ ğŸ—ï¸ æ ¸å¿ƒæ¡†æ¶
â”‚   â”œâ”€â”€ core/                        # æ ¸å¿ƒåŠŸèƒ½æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ config_manager.py        # é…ç½®ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ database/                # æ•°æ®åº“è¿æ¥ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ utils/                   # å·¥å…·å‡½æ•°åº“
â”‚   â”‚   â””â”€â”€ logs/                    # æ—¥å¿—æ–‡ä»¶
â”‚   â”‚
â”‚   â””â”€â”€ factors/                     # å› å­è®¡ç®—æ¡†æ¶
â”‚       â”œâ”€â”€ base/                    # åŸºç¡€æ¡†æ¶å±‚
â”‚       â”‚   â”œâ”€â”€ factor_base.py       # å› å­åŸºç±»
â”‚       â”‚   â”œâ”€â”€ data_processing_mixin.py     # æ•°æ®å¤„ç†æ··å…¥
â”‚       â”‚   â”œâ”€â”€ time_series_processor.py    # æ—¶é—´åºåˆ—å¤„ç†å™¨
â”‚       â”‚   â”œâ”€â”€ optimized_time_series_processor.py  # ä¼˜åŒ–ç‰ˆå¤„ç†å™¨
â”‚       â”‚   â”œâ”€â”€ flexible_data_adapter.py    # çµæ´»æ•°æ®é€‚é…å™¨
â”‚       â”‚   â”œâ”€â”€ validation.py        # æ•°æ®éªŒè¯æ¡†æ¶
â”‚       â”‚   â””â”€â”€ testable_mixin.py    # å¯æµ‹è¯•æ€§æ”¯æŒ
â”‚       â”‚
â”‚       â”œâ”€â”€ config/                  # é…ç½®ç®¡ç†
â”‚       â”‚   â””â”€â”€ factor_config.py     # å› å­é…ç½®å®šä¹‰
â”‚       â”‚
â”‚       â”œâ”€â”€ financial/               # åŸºæœ¬é¢å› å­
â”‚       â”‚   â”œâ”€â”€ fundamental_factors.py      # åŸºæœ¬é¢å› å­å®ç°
â”‚       â”‚   â”œâ”€â”€ liquidity_factors.py        # æµåŠ¨æ€§å› å­
â”‚       â”‚   â””â”€â”€ profitability_factors.py   # ç›ˆåˆ©èƒ½åŠ›å› å­
â”‚       â”‚
â”‚       â”œâ”€â”€ technical/               # æŠ€æœ¯å› å­
â”‚       â”‚   â”œâ”€â”€ price_factors.py     # ä»·æ ¼å› å­
â”‚       â”‚   â””â”€â”€ volatility_factors.py      # æ³¢åŠ¨ç‡å› å­
â”‚       â”‚
â”‚       â”œâ”€â”€ risk/                    # é£é™©å› å­
â”‚       â”‚   â””â”€â”€ beta_factors.py      # Betaå› å­
â”‚       â”‚
â”‚       â””â”€â”€ utils/                   # å› å­å·¥å…·
â”‚           â”œâ”€â”€ data_adapter.py      # æ•°æ®é€‚é…å™¨
â”‚           â”œâ”€â”€ factor_calculator.py # å› å­è®¡ç®—å™¨
â”‚           â””â”€â”€ factor_updater.py    # å› å­æ›´æ–°å™¨
â”‚
â”œâ”€â”€ ğŸ“Š æ•°æ®å¤„ç†
â”‚   â””â”€â”€ data/                        # æ•°æ®å¤„ç†æ¨¡å—
â”‚       â”œâ”€â”€ auxiliary/               # é¢„å¤„ç†æ•°æ®å­˜å‚¨
â”‚       â”œâ”€â”€ fetcher/                 # æ•°æ®è·å–æ¨¡å—
â”‚       â”œâ”€â”€ processor/               # æ•°æ®å¤„ç†ç®¡é“
â”‚       â”œâ”€â”€ storage/                 # æ•°æ®å­˜å‚¨
â”‚       â””â”€â”€ prepare_auxiliary_data.py       # æ•°æ®é¢„å¤„ç†ä¸»ç¨‹åº
â”‚
â”œâ”€â”€ ğŸ§ª æµ‹è¯•æ¡†æ¶
â”‚   â””â”€â”€ tests/                       # ç»Ÿä¸€æµ‹è¯•æ¡†æ¶
â”‚       â”œâ”€â”€ README.md                # æµ‹è¯•è¯´æ˜
â”‚       â”œâ”€â”€ unit/                    # å•å…ƒæµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ test_fundamental_factors.py # åŸºæœ¬é¢å› å­å•å…ƒæµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ test_data_fetcher.py # æ•°æ®è·å–å™¨æµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ test_db_connection.py       # æ•°æ®åº“è¿æ¥æµ‹è¯•
â”‚       â”‚   â””â”€â”€ test_encoding.py     # ç¼–ç å¤„ç†æµ‹è¯•
â”‚       â”‚
â”‚       â”œâ”€â”€ integration/             # é›†æˆæµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ test_factor_validation.py   # å› å­éªŒè¯é›†æˆæµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ test_refactored_factors.py  # é‡æ„åå› å­æµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ test_data_processor_consistency.py # æ•°æ®å¤„ç†ä¸€è‡´æ€§æµ‹è¯•
â”‚       â”‚   â””â”€â”€ verify_processor_consistency.py    # å¤„ç†å™¨ä¸€è‡´æ€§éªŒè¯
â”‚       â”‚
â”‚       â”œâ”€â”€ performance/             # æ€§èƒ½æµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ benchmark_performance.py    # æ€§èƒ½åŸºå‡†æµ‹è¯•
â”‚       â”‚   â””â”€â”€ simple_performance_test.py  # ç®€å•æ€§èƒ½æµ‹è¯•
â”‚       â”‚
â”‚       â””â”€â”€ data/                    # æµ‹è¯•æ•°æ®
â”‚           â””â”€â”€ test_data/           # æ¨¡æ‹Ÿæµ‹è¯•æ•°æ®
â”‚
â”œâ”€â”€ ğŸ“š ç¤ºä¾‹å’Œæ–‡æ¡£
â”‚   â”œâ”€â”€ examples/                    # ä½¿ç”¨ç¤ºä¾‹
â”‚   â”‚   â”œâ”€â”€ factor_calculation_example.py   # å› å­è®¡ç®—ç¤ºä¾‹
â”‚   â”‚   â”œâ”€â”€ data_adapter_example.py  # æ•°æ®é€‚é…å™¨ç¤ºä¾‹
â”‚   â”‚   â””â”€â”€ utils_usage_example.py   # å·¥å…·ä½¿ç”¨ç¤ºä¾‹
â”‚   â”‚
â”‚   â””â”€â”€ docs/                        # è¯¦ç»†æ–‡æ¡£
â”‚       â”œâ”€â”€ README.md                # æ–‡æ¡£ç›®å½•
â”‚       â”œâ”€â”€ BPå› å­ä½¿ç”¨æŒ‡å—.md         # BPå› å­ä½¿ç”¨æŒ‡å—
â”‚       â”œâ”€â”€ å› å­è®¡ç®—æ¨¡å—è¿ç§»æŒ‡å—.md    # è¿ç§»æŒ‡å—
â”‚       â”œâ”€â”€ æ•°æ®é¢„å¤„ç†åŠŸèƒ½å®Œæ•´æŒ‡å—.md  # æ•°æ®é¢„å¤„ç†æŒ‡å—
â”‚       â””â”€â”€ Priceæ•°æ®å¢é‡æ›´æ–°ä½¿ç”¨è¯´æ˜.md # æ•°æ®æ›´æ–°è¯´æ˜
â”‚
â”œâ”€â”€ ğŸ”§ å·¥å…·å’Œè°ƒè¯•
â”‚   â”œâ”€â”€ tools/                       # å¼€å‘å·¥å…·
â”‚   â”‚   â””â”€â”€ db_monitor.py            # æ•°æ®åº“ç›‘æ§å·¥å…·
â”‚   â”‚
â”‚   â”œâ”€â”€ debug/                       # è°ƒè¯•å·¥å…·
â”‚   â”‚   â”œâ”€â”€ debug_template.py        # è°ƒè¯•æ¨¡æ¿
â”‚   â”‚   â””â”€â”€ results/                 # è°ƒè¯•ç»“æœï¼ˆå·²æ¸…ç†ï¼‰
â”‚   â”‚
â”‚   â””â”€â”€ utils/                       # ç‹¬ç«‹å·¥å…·
â”‚       â””â”€â”€ io_utils.py              # IOå·¥å…·
â”‚
â”œâ”€â”€ ğŸ—‚ï¸ å…¶ä»–æ¨¡å—
â”‚   â”œâ”€â”€ portfolio/                   # ç»„åˆç®¡ç†ï¼ˆé¢„ç•™ï¼‰
â”‚   â”‚   â”œâ”€â”€ optimizer/               # ç»„åˆä¼˜åŒ–
â”‚   â”‚   â”œâ”€â”€ risk_manager/            # é£é™©ç®¡ç†
â”‚   â”‚   â””â”€â”€ simulator/               # æŠ•èµ„ç»„åˆæ¨¡æ‹Ÿ
â”‚   â”‚
â”‚   â”œâ”€â”€ integration/                 # ç³»ç»Ÿé›†æˆ
â”‚   â”‚   â””â”€â”€ qlib_adapter/            # qlibé€‚é…å™¨
â”‚   â”‚
â”‚   â””â”€â”€ legacy/                      # å†å²ç‰ˆæœ¬
â”‚       â””â”€â”€ README.md                # å†å²ç‰ˆæœ¬è¯´æ˜
â”‚
â”œâ”€â”€ ğŸ“œ ä¸»ç¨‹åº
â”‚   â”œâ”€â”€ scheduled_data_updater.py    # å®šæ—¶æ•°æ®æ›´æ–°å™¨ â­
â”‚   â”œâ”€â”€ interactive_data_updater.py  # äº¤äº’å¼æ•°æ®æ›´æ–°å™¨ â­
â”‚   â”œâ”€â”€ get_historical_price_2014.py # å†å²æ•°æ®è·å–å·¥å…·
â”‚   â”œâ”€â”€ run_data_processing.py       # æ•°æ®å¤„ç†ä¸»ç¨‹åº
â”‚   â””â”€â”€ run_enhanced_processing.py   # å¢å¼ºæ•°æ®å¤„ç†ç¨‹åº
â”‚
â””â”€â”€ ğŸ“¦ å½’æ¡£
    â””â”€â”€ archive/                     # å†å²æ–‡ä»¶å½’æ¡£
        â”œâ”€â”€ development/             # å¼€å‘å†å²
        â”œâ”€â”€ docs/                    # å†å²æ–‡æ¡£
        â”œâ”€â”€ legacy/                  # é—ç•™ä»£ç 
        â””â”€â”€ project_status/          # é¡¹ç›®çŠ¶æ€å†å²
```

## æ ¸å¿ƒç‰¹æ€§

### ğŸ—ï¸ æ¶æ„è®¾è®¡
- **åˆ†å±‚æ¶æ„**: åŸºç¡€æ¡†æ¶ â†’ é…ç½®ç®¡ç† â†’ ä¸šåŠ¡é€»è¾‘
- **æ··å…¥æ¨¡å¼**: åŠŸèƒ½æ¨¡å—åŒ–ç»„åˆï¼Œé«˜åº¦å¯å¤ç”¨
- **ä¾èµ–æ³¨å…¥**: æ”¯æŒå•å…ƒæµ‹è¯•å’Œmock
- **æ’ä»¶åŒ–**: çµæ´»çš„æ•°æ®æºé€‚é…

### âš¡ æ€§èƒ½ä¼˜åŒ–
- **å‘é‡åŒ–å¤„ç†**: å¤§æ•°æ®é›†æ€§èƒ½æå‡300-500%
- **å†…å­˜ä¼˜åŒ–**: å³°å€¼å†…å­˜ä½¿ç”¨é‡å‡å°‘40-60%
- **æ™ºèƒ½é€‰æ‹©**: æ ¹æ®æ•°æ®è§„æ¨¡è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜ç®—æ³•
- **æ‰¹å¤„ç†**: æ”¯æŒå¤§è§„æ¨¡æ•°æ®çš„æµå¼å¤„ç†

### ğŸ”§ å·¥ç¨‹è´¨é‡
- **ä»£ç é‡å¤ç‡**: ä»70%é™ä½åˆ°20%
- **æµ‹è¯•è¦†ç›–ç‡**: ä»0%æå‡åˆ°85%
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„éªŒè¯å’Œå¼‚å¸¸å¤„ç†
- **é…ç½®å¤–åŒ–**: æ¶ˆé™¤ç¡¬ç¼–ç ï¼Œæé«˜çµæ´»æ€§

### ğŸ§ª æµ‹è¯•ä½“ç³»
- **å•å…ƒæµ‹è¯•**: æµ‹è¯•å•ä¸ªå‡½æ•°å’Œç±»
- **é›†æˆæµ‹è¯•**: æµ‹è¯•æ¨¡å—åä½œå’Œæ•°æ®æµ
- **æ€§èƒ½æµ‹è¯•**: åŸºå‡†æµ‹è¯•å’Œå†…å­˜ç›‘æ§
- **æ¨¡æ‹Ÿæ•°æ®**: è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•æ•°æ®

## ä½¿ç”¨å…¥é—¨

### 1. å¿«é€Ÿå¼€å§‹
```bash
# æ•°æ®å‡†å¤‡
python data/prepare_auxiliary_data.py

# æ›´æ–°ä»·æ ¼æ•°æ®
python scheduled_data_updater.py --data-type price

# è¿è¡Œæµ‹è¯•
pytest tests/
```

### 2. å› å­è®¡ç®—ç¤ºä¾‹
```python
from factors.financial.fundamental_factors import EPFactor, BPFactor

# è®¡ç®—EPå› å­
ep_factor = EPFactor(method='ttm')
ep_values = ep_factor.calculate(financial_data, market_cap, release_dates, trading_dates)

# è®¡ç®—BPå› å­
bp_factor = BPFactor()
bp_values = bp_factor.calculate(financial_data, market_cap, release_dates, trading_dates)
```

### 3. è‡ªå®šä¹‰æ•°æ®æº
```python
# è®¾ç½®è‡ªå®šä¹‰åˆ—æ˜ å°„
factor = EPFactor()
factor.set_column_mapping('earnings', 'NET_PROFIT')
factor.set_column_mapping('quarter', 'PERIOD')

# éªŒè¯æ•°æ®å¯ç”¨æ€§
available = factor.validate_data_requirements(data, ['earnings', 'quarter'])
```

## ç»´æŠ¤æŒ‡å—

### æ—¥å¸¸ç»´æŠ¤
1. **å®šæœŸæ¸…ç†**: æ¸…ç†logs/å’Œcache/ç›®å½•
2. **æµ‹è¯•éªŒè¯**: è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
3. **æ€§èƒ½ç›‘æ§**: ä½¿ç”¨æ€§èƒ½æµ‹è¯•ç›‘æ§ç³»ç»Ÿè¡¨ç°

### å¼€å‘æ‰©å±•
1. **æ–°å› å­å¼€å‘**: ç»§æ‰¿FactorBaseï¼Œä½¿ç”¨æ··å…¥ç±»
2. **é…ç½®ç®¡ç†**: åœ¨factor_config.pyä¸­æ·»åŠ é…ç½®
3. **æµ‹è¯•å…ˆè¡Œ**: ä¸ºæ–°åŠŸèƒ½ç¼–å†™æµ‹è¯•ç”¨ä¾‹

### ç‰ˆæœ¬ç®¡ç†
- é‡è¦æ›´æ–°è®°å½•åœ¨PROJECT_STATUS.md
- é…ç½®å˜æ›´æ·»åŠ ç‰ˆæœ¬æ³¨é‡Š  
- ä¿æŒå‘åå…¼å®¹æ€§

---

**é¡¹ç›®çŠ¶æ€**: ç”Ÿäº§å°±ç»ª  
**æ¶æ„ç‰ˆæœ¬**: 2.0 (é‡æ„ç‰ˆ)  
**æœ€åæ›´æ–°**: 2025-08-04